---
import BaseLayout from '~/layouts/BaseLayout.astro';
import { buttonVariants } from '~/components/ui/button';
import { cn } from '~/lib/utils';
import { AlertTriangle, ArrowRight } from 'lucide-react';

interface Props {
  error: unknown;
}

const { error } = Astro.props;

const seo = {
  title: 'Server Error - GREENTECH',
  description: 'An internal server error occurred. Please try again or contact our support team.',
  noindex: true, // Don't index error pages
};

// Safe error message extraction
const getErrorMessage = (error: unknown): string => {
  if (error instanceof Error) {
    return error.message;
  }
  return 'An unexpected error occurred';
};

const errorMessage = getErrorMessage(error);
---

<BaseLayout seo={seo}>
  <div class="min-h-[calc(100vh-theme(spacing.18)-theme(spacing.16))] flex items-center justify-center px-4 py-16">
    <div class="max-w-md mx-auto text-center">
      <!-- Error illustration -->
      <div class="mb-8">
        <div class="w-24 h-24 mx-auto mb-6 bg-destructive/10 rounded-full flex items-center justify-center">
          <AlertTriangle className="w-12 h-12 text-destructive" client:load />
        </div>
        <h1 class="text-6xl font-bold text-destructive mb-4">500</h1>
        <h2 class="text-2xl font-semibold text-foreground mb-4">Server Error</h2>
        <p class="text-muted-foreground mb-8">
          We're experiencing some technical difficulties. Our team has been notified and is working to resolve the issue.
        </p>
        
        <!-- Development error details (only show generic message in production) -->
        {import.meta.env.DEV && errorMessage && (
          <div class="bg-muted p-4 rounded-lg mb-8 text-left">
            <p class="text-sm font-medium mb-2">Error Details (Development):</p>
            <code class="text-xs text-destructive break-all">{errorMessage}</code>
          </div>
        )}
      </div>

      <!-- Navigation options -->
      <div class="space-y-4 mb-8">
        <a href="/" class={cn(buttonVariants({ variant: "default", size: "lg" }), "w-full")}>
          Return Home
        </a>
        <button 
          onclick="window.location.reload()" 
          class={cn(buttonVariants({ variant: "outline", size: "lg" }), "w-full")}
        >
          Try Again
        </button>
        <a href="/contact" class={cn(buttonVariants({ variant: "outline", size: "lg" }), "w-full")}>
          Contact Support
        </a>
      </div>

      <!-- Quick links -->
      <div class="border-t pt-6">
        <p class="text-sm font-medium text-foreground mb-4">While we fix this, explore:</p>
        <div class="grid grid-cols-1 gap-2">
          <a
            href="/company"
            class="text-primary hover:text-primary/80 text-sm transition-colors flex items-center justify-center gap-2"
          >
            About GREENTECH
            <ArrowRight className="w-3 h-3" client:load />
          </a>
          <a
            href="/solutions"
            class="text-primary hover:text-primary/80 text-sm transition-colors flex items-center justify-center gap-2"
          >
            Sustainable Solutions
            <ArrowRight className="w-3 h-3" client:load />
          </a>
          <a
            href="/brands"
            class="text-primary hover:text-primary/80 text-sm transition-colors flex items-center justify-center gap-2"
          >
            Our Brands
            <ArrowRight className="w-3 h-3" client:load />
          </a>
          <a
            href="/industries"
            class="text-primary hover:text-primary/80 text-sm transition-colors flex items-center justify-center gap-2"
          >
            Industries We Serve
            <ArrowRight className="w-3 h-3" client:load />
          </a>
        </div>
      </div>
    </div>
  </div>
</BaseLayout>